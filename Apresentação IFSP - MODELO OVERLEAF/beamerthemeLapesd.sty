%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Based on JAutomation Beamer Theme
% https://github.com/makokal/beamer-themes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ProvidesPackage{beamerthemeLapesd}[2013/12/04]

\definecolor{JLightGray}{RGB}{225,225,225}
\definecolor{JGray}{RGB}{168,168,168}
\definecolor{JLightBlue}{RGB}{124,145,198}
\definecolor{JBlue}{RGB}{33,69,143}

\definecolor{JGreen}{RGB}{0,102,0}
\definecolor{JLightGreen}{RGB}{0,179,0}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Outer theme
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\useoutertheme[width=.15\paperwidth]{sidebar}
\setlength{\beamer@headheight}{.165\paperheight}
\pgfdeclareimage[width=.13\paperwidth]{small-logo}{fig/Marca_IFSP_2015-01.jpg}
\pgfdeclareimage[width=.23\paperwidth]{main-logo}{fig/Marca_IFSP_2015-03.jpg} % Imagem do canto esquedo da Abertura
\pgfdeclareimage[width=.15\paperwidth]{ifsp-logo}{fig/Marca_IFSP_2015-03.jpg} %Imagem do canto direito da Abertura
\pgfdeclareimage[width=.33\paperwidth]{large-corner}{fig/Logomarca_IFSP.jpg}
\pgfdeclareimage[height=\beamer@headheight]{small-corner}{fig/Logomarca_IFSP.jpg}
\pgfdeclareimage[width=\paperwidth]{ifsp_topo}{fig/Marca_IFSP_2015-01.jpg} % Imagem Topo centro
\setbeamertemplate{sidebar left}{%
\vskip7pt
\insertverticalnavigation{\beamer@sidebarwidth}% Barra Lateral
}

% Conteudo do Rodapé
\setbeamertemplate{footline}[text line]{%
\insertshortauthor\strut\hfill\insertshorttitle\hfill\insertshortdate\hspace{1em}\insertframenumber/\inserttotalframenumber}
%\strut\insertshortdate\hfill\insertshorttitle\hfill\insertframenumber/\inserttotalframenumber}

\addtobeamertemplate{frametitle}{}{%
\begin{pgfpicture}
\pgf@relevantforpicturesizefalse
\pgftransformxshift{-\Gm@lmargin}
\pgftransformyshift{\beamer@headheight+18pt}
%\pgftext[at=\pgfpoint{\paperwidth}{-\beamer@headheight},right,base]{\pgfuseimage{}}
\pgftext[at=\pgfpoint{.075\paperwidth}{-.16\paperheight},center,base]{\pgfuseimage{small-corner}} % Logomarca na barra lateral 
\pgfpathmoveto{\pgfpoint{.15\paperwidth}{0pt}}
\pgfpathlineto{\pgfpoint{.15\paperwidth}{-\beamer@headheight}}
\pgfsetlinewidth{3.5pt}
\pgfsetinnerlinewidth{1pt}
\pgfsetinnerstrokecolor{JGreen}
\pgfsetcolor{white}
\pgfusepath{stroke}
\pgfpathmoveto{\pgfpoint{.15\paperwidth}{-.23\paperheight}}
\pgfpathlineto{\pgfpoint{.15\paperwidth}{-.97\paperheight}}
\pgfsetlinewidth{1pt}
\pgfsetinnerlinewidth{0pt}
\pgfsetcolor{JGreen}
\pgfusepath{stroke}
%\pgftext[at=\pgfpoint{.075\paperwidth}{-.97\paperheight},center,base]{\pgfuseimage{small-corner}}
\end{pgfpicture}%
\vskip-25pt%
}

\addtobeamertemplate{title page}{%
\usebeamertemplate{title background}%
\vskip .40\paperheight% Posição do Titulo na introdução
}

\newcommand\DoPurpleBackground{%
\pgfpathmoveto{\pgfpointorigin}
\pgfpathrectanglecorners{\pgfpoint{0pt}{0pt}}{\pgfpoint{\paperwidth}{-\paperheight}}
\pgfsetfillcolor{JGreen}
\pgfusepath{fill}
}


\setbeamertemplate{title background}{%
\begin{pgfpicture}
\pgf@relevantforpicturesizefalse
%\pgftransformxshift{\Gm@lmargin}
\pgftransformxshift{-41.5pt}
\pgftransformyshift{5.5pt}
\pgfusepath{fill}
\DoPurpleBackground
\pgftext[at=\pgfpoint{.0001\paperwidth}{-.40\paperheight},left,base]{\pgfuseimage{ifsp_topo}}

% Logo
%\pgftext[at=\pgfpoint{.001\paperwidth}{-.99\paperheight},left,base]{\pgfuseimage{main-logo}}
%\pgftext[at=\pgfpoint{.83\paperwidth}{-.98\paperheight},left,base]{\pgfuseimage{ifsp-logo}}
\end{pgfpicture}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Inner Theme
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\useinnertheme{rectangles}
\setbeamertemplate{navigation symbols}{}

\setlength{\leftmargini}{.5em}
\setlength{\leftmarginii}{1.0em}
\setlength{\leftmarginiii}{1.5em}
\setlength{\leftmarginiv}{2.0em}
\setlength{\leftmarginv}{2.5em}
\setlength{\leftmarginvi}{3.0em}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Colours
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usecolortheme[named=JGreen]{structure}
\usecolortheme{rose}
\setbeamercolor{title}{fg=JGreen,bg=JLightGray,use=structure}
\setbeamercolor{title page}{fg=white}
\setbeamercolor{logo}{bg=white} % Cor de fundo do topo da barra lateral
\setbeamercolor{frametitle}{fg=JLightGray,bg=JGreen}
\setbeamercolor{section in sidebar}{fg=JGreen}
\setbeamerfont{section in sidebar}{series=\bfseries}
\setbeamercolor{block title}{bg=JGreen!28!white,fg=JGreen}
\setbeamercolor{block body}{bg=JGreen!15!white}

\newcommand\ThankYouFrame{
\begin{frame}[plain,t]
\begin{pgfpicture}
\pgf@relevantforpicturesizefalse
\pgftransformxshift{-\Gm@lmargin}
\pgftransformyshift{5.5pt}
\DoPurpleBackground
\end{pgfpicture}
\end{frame}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Misc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{caption}[numbered]
